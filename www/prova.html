<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <link rel="shortcut icon" href="favicon.ico" />

    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

    <!-- Google Maps API & Places -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&&libraries=places"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>

    <title>TravelVR</title>
  </head>
  <style type="text/css">
    html, body, #map-canvas 
    { 
      height: 400px;
      width: 400px;
      margin: 0; 
      padding: 0;
    }

    .gm-style-cc { display:none; }

  </style>
  <script type="text/javascript">
    var map;
    var m;
    function initialize() {
      var mapOptions = {
        center: { lat: -34.397, lng: 150.644},
        zoom: 8,
        disableDefaultUI: true,
      };
      map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

      var image = {
        url: 'logos/cardboard-marker.png',
        size: new google.maps.Size(50, 50),
        origin: new google.maps.Point(0,0),
        anchor: new google.maps.Point(25, 25)
      };
      //parte da modificare con php
      var marker = [];

      

      function placeMarker(location) {
        if (m) {
          m.setPosition(location);
        } else {
          m = new google.maps.Marker({
            position: location,
            map: map,
            icon : image,
          });
        }
      }

      google.maps.event.addListener(map, 'click', function(event) {
        placeMarker(event.latLng);
        document.getElementById("lat").value = event.latLng.lat();
        document.getElementById("long").value = event.latLng.lng();
      });
      
      
      
    }
    //Geolocation function
    function UserPosition() {
      if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var userLocation = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
          map.setCenter(userLocation);
          var m = new google.maps.Marker({
            position: userLocation,
            map: map,
          });
          map.setZoom(13);
        }, function() {
          alert("Questa app desidera utilizzare il GPS per rilevare la posizione. Abilitare la posizione fucking man");
        });
      }
    }
    
    function DO() {
        var io = m.getPosition().lat()-0.5;
        var te = m.getPosition().lng();
        map.setCenter(m.getPosition().lat()-0.5,m.getPosition().lng());
      }


    google.maps.event.addDomListener(window, 'load', initialize);
  </script>

  <body>
    <div id="map-canvas"></div>
    <input id="trol" onclick=" DO()" type="button" value="FIGO">
    <input id = "lat" type="text" placeholder="LAT">
    <input id = "long" type="text" placeholder="LONG">
    <a id="geoloc" onclick="UserPosition()" class="btn-floating btn-large waves-effect waves-light indigo accent-3 z-depth-5"><i class="mdi-device-gps-fixed"></i></a>
  </body>
</html>